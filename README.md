# omar-centi-sde-task
## NTY Books API list overview ingestion and reporting

[![Build Status](https://travis-ci.org/joemccann/dillinger.svg?branch=master)](https://github.com/ilmancino/omar-centi-sde-task)

The application fetches data from the overview endpoint for the years 2021 to 2023, store the data in PostgreSQL (into a fact table and corresponding dimensions).

Content of this page:
- Dimensional modeling
- Instructions for running the appliaction
- Reports

## Dimensional Modeling

- Fact table grain: one entry per each book that appeared in a list on every publication
- Fact table: fact_publications
- Dimensions: dim_lists, dim_books, dim_date

**Notes**:
- I added dim_published_date to the model, but I didn't add it to the final implemetation; instead I added the actual dates to the fact table. The reason is because, even when a Date dimension facilitates quicker and enriched analysis. It was not really necesary for the reports in this evaluation task.

![Model](https://storage.googleapis.com/centi_public/images/NTY%20API%20Data%20Model.png)

## Instructions for running the appliaction

The application is conteinerized with Docker and uses a second container as a dependency for the database. Details below:
- Base image for application's image: python:3.12.2-bullseye
- DB image: postgres:16.3-bullseye

I have used docker compose to orchestrate the execution of the application and its dependency. To run the application the only required step is to execute the file run_application.sh present in this repository.

**Command**:
```sh
./run_application.sh {NTY API Key} {DB User} {DB Password}
```

**Note**:
I found that the NYT API only allows me to execute 5 requests per minute, so I added a stop of a few seconds to the application to void exceeding the limit. **This delays the execution**.

**Prerequisites**:
- Docker installed in your computer
- Login into docker
- Move into the repository's main folder
- Assign execution permissions to the file: ./run_application.sh

## Reports Notes

- For the first report requested, I created to versions as I wasn't sure if the ask was about the books remaining continuously on the top 3 or even on separate publications. I created both versions. 
- In my queries I consider books with same title and author but different isbn as a different book, as the isbn changes when an important change in made to a book. The numbers this way can be different than consider those books the same, I consider both analysis valid.
- The reports have already been generated and the results added to the repository for convenience (but they will also be generated by the application and can be obtained from the container)
